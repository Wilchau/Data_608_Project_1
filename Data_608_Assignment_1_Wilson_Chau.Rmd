---
title: "Data 608 Homework 1"
author: "Wilson Chau"
date: "2023-02-13"
output: html_document
---
---
title: "R Notebook"
output:
  html_document: default
  html_notebook: default
---
#Library

```{r}
require(dplyr)
require(tidyr)
require(knitr)
require(kableExtra)
require(kable)
require(ggplot2)
```
**Principles of Data Visualization and Introduction to ggplot2**

I have provided you with data about the 5,000 fastest growing companies in the US, as compiled by Inc. magazine. lets read this in:

```{r}
inc <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module1/Data/inc5000_data.csv", header= TRUE)
```

And lets preview this data:

```{r}
head(inc)
```
```{r}
summary(inc)
```

Think a bit on what these summaries mean. Use the space below to add some more relevant non-visual exploratory information you think helps you understand this data:

#My thoughts
Going through the quick brief of data i saw from the follwowing codes there is a growth rate of 5,000 fastest growing companies around 1-4%, but a few outliers to research into. I also see a MEDIAN amount of revenue generated by companies to be $10,000,000 and the median # of employees per company is 53.


## Question 1

Create a graph that shows the distribution of companies in the dataset by State (ie how many are in each state). There are a lot of States, so consider which axis you should use. This visualization is ultimately going to be consumed on a 'portrait' oriented screen (ie taller than wide), which should further guide your layout choices.

```{r}
comp_state <- inc %>% 
  group_by(State) %>% 
  summarise(Number_of_companies = n()) %>% 
  arrange(desc(Number_of_companies))
a <- ggplot(comp_state, aes(x = reorder(State, Number_of_companies), y = Number_of_companies)) 
a <- a + geom_bar(stat = "identity", fill = "#009a9c") + coord_flip()
a <- a + scale_y_continuous(expand = c(0, 0), limits = c(0, 900)) 
a <- a + ggtitle("The 5,000 Fastest Growing \nCompanies in the U.S. (by State)")
a <- a + geom_hline(yintercept=seq(1,800,250), col="white", lwd=1)
a <- a + ylab("Number of Companies")
a <- a + xlab("State")
a <- a + geom_text(aes(label = Number_of_companies, size = 1), vjust = 0.20, hjust = -0.25, size=2.5, fontface='bold', color="#009a9c")
a <- a + theme(plot.title = element_text(size=12, face="bold", hjust = 0.25),
        axis.text=element_text(size=9, face = "bold"),
        axis.title=element_text(size=9,face="bold", color = "#555555"),
        panel.background = element_blank(),
        axis.line = element_line(color = "#cccccc", 
                      size = 0.5, linetype = "solid"),
        axis.ticks.y = element_blank(),
        axis.ticks.x = element_line(color="#cccccc"))
a
```
I used the bar graph to show the fastest growing company first. This empahsize that the #1 company on top is the fastest VS all the other companies. 
## Quesiton 2

Lets dig in on the state with the 3rd most companies in the data set. Imagine you work for the state and are interested in how many people are employed by companies in different industries. Create a plot that shows the average and/or median employment by industry for companies in this state (only use cases with full data, use R's `complete.cases()` function.) In addition to this, your graph should show how variable the ranges are, and you should deal with outliers.

```{r}
New_York_Companies <- inc %>% 
  filter(State == 'NY') %>% 
  filter(complete.cases(.))
```
This creates the filter where I can isolate for NEW YORK COMPANIES ONLY
Then I will focus on statistics of NEW YORK
```{r}
mean_industry <- New_York_Companies %>% 
  group_by(Industry) %>% 
  summarise(Mean_employees = mean(Employees))

mean_industry_max <- max(mean_industry$Mean_employees)
ny_companies_max <- max(New_York_Companies$Employees)
```
Then I graph this out
```{r}
g <- ggplot(New_York_Companies, aes(x= reorder(Industry, Employees, mean), y=Employees))
g <- g + geom_boxplot(width = 0.5, fill = "aliceblue", fatten = 2, color="#333333", alpha=0.2) + coord_flip()
g <- g + geom_point(data = mean_industry, aes(x=Industry, y=Mean_employees, fill = "Mean Employees"),  color="maroon", size = 2, show.legend = TRUE)
g <- g + scale_y_continuous(expand = c(0,0), limits = c(0, mean_industry_max + 50))
g <- g + ggtitle("Distribution of Employees per Industry (New York State)")
g <- g + ylab("Employees")
g <- g + xlab("Industry")
g <- g + theme_bw()
g <- g + theme(plot.title = element_text(size=12, face="bold", hjust = 0.5, color = "#555555"),
        axis.text=element_text(size=9, face = "bold"),
        axis.title=element_text(size=9,face="bold", color = "#555555"),
        panel.background = element_blank(),
        panel.border = element_blank(),
        axis.line = element_line(color = "#cccccc", 
                      size = 0.5, linetype = "solid"),
        axis.ticks.y = element_blank(),
        axis.ticks.x = element_line(color="#cccccc"),
        legend.position = "top")
g <- g + labs(fill = "")
g
```
Based on this graph I can see that there is a lot of Employees in the Travel & Hospitality industry, versus Business Products & Services where the outlier is over 1,000 for 1 of the companies. 
## Question 3

Now imagine you work for an investor and want to see which industries generate the most revenue per employee. Create a chart that makes this information clear. Once again, the distribution per industry should be shown.

By utilzing GROUP BY I was able to focus on organizing the data to show the mean revenue per employee for every industry in the dataset 
```{r}
rev_emp <- inc %>% 
  filter(complete.cases(.)) %>% 
  group_by(Industry) %>% 
  summarise(Rev_total = sum(Revenue), Employee_total =  sum(Employees)) %>%
  mutate(Revenue_per_employee = Rev_total / Employee_total) %>% 
  arrange(desc(Revenue_per_employee))
a <- ggplot(rev_emp, aes(x = reorder(Industry, Revenue_per_employee), y = Revenue_per_employee)) 
a <- a + geom_bar(stat = "identity", fill = "#009a9c") + coord_flip()
a <- a + scale_y_continuous(expand = c(0, 0), limits = c(0, 1500000), breaks = c(0, 500000, 1000000), labels = scales::comma) 
a <- a + ggtitle("Revenue per Employee by Industry of the 5,000 Fastest Growing \nCompanies in the U.S.")
a <- a + geom_hline(yintercept=seq(0,1500000,250000), col="white", lwd=1)
a <- a + ylab("Revenue per Employee")
a <- a + xlab("Industry")
a <- a + geom_text(aes(label = scales::comma(round(Revenue_per_employee, 0)), size = 1), vjust = 0.20, hjust = -0.15, size=2.5, fontface='bold', color="#009a9c")
a <- a + theme(plot.title = element_text(size=11, face="bold", color = "#555555"),
        axis.text=element_text(size=9, face = "bold"),
        axis.title=element_text(size=9,face="bold", color = "#555555"),
        panel.background = element_blank(),
        axis.line = element_line(color = "#cccccc", 
                      size = 0.5, linetype = "solid"),
        axis.ticks.y = element_blank(),
        axis.ticks.x = element_line(color="#cccccc"))
a
```
Based on this graph we can see Computer Hardware makes the most revenue per employee. 
